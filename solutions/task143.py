def p(g,i=1):
	*R,=G=sum(g,[]);L=b"\0\n"
	for k in L:R[k+i]=R[k]and 5
	return[[R.pop(0)for _ in r]for r in g*all(-G[k+i]^-G[k]>-1!={*G}!={*R}for k in L)]or p(g,i+1)