p=lambda g,n=23:-n*g or[[r.pop()or(y>0)*[5,w:=max(max(g))][n//4%((f'0, {w}, '*2in'%s'%g)-3)]for y in[0]+r[:0:-1]]for*r,in zip(*p(g,n-1))]