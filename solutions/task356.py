p=lambda g,e=enumerate:[[max({*r[:j+1]}&{*r[j:]}|{*h[:i]}&{*h[i:]})for j,h in e(zip(*g))]for i,r in e(g)]