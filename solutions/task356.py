p=lambda g,*r,i=0:[max({*g[i:],x}&{*g[:(i:=i+1)],x})for x in r]or[*map(p,g,*map(p,zip(*g),*g))]