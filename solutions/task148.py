p=lambda g,X=0:[[X:=-any(r)&1+X%6,[332%(2+sum(r[:i+1])*sum(r[i:]))or(X in g)*8for i,x in enumerate(r)],g:=g+[X]*(8in r)][1]for r in g]