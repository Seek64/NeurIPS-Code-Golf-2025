p=lambda g,*p:[[p for*c,e in zip(*g,L)if[p:=e or p][any(c):]]+[p]for l in g+[p]if~-any(l)or(L:=l)*0]