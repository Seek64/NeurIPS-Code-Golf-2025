p=lambda g,n=3:-n*g or p([*zip(*sorted(f:=g+[9*[8]],key=lambda r:g.extend(r)or 2-any(2//max(max(f,key=any))*r)in g)[-2::-1])],n-1)