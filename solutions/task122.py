p=lambda g:max(map(sum,g))<8and g[-2-len(g)%2:][:2]+g[:-2]or[*zip(*p([*zip(*g)]))]