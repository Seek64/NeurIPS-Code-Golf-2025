def p(t):e=sum(t,[]);r=len(t[0]);*n,u=sorted((len(e)-e[::-1].index(n)-e.index(n),n)for n in{*e});p=n[-1][0]//r+1;e+=(t:=p*r*[u[1]]);[t:=[(t[u],n)[e[e.index(n)+u-(p*r-r+p-s)//2]==n]for u in range(p*r)]for s,n in n];return[t[u*r:][:p]for u in range(p)]