p=lambda g,*r,i=0:[max({*g[i::3],x}&{*g[:(i:=i+1)],x})for x in r]or[*map(p,g,*map(p,zip(*g),*g))]