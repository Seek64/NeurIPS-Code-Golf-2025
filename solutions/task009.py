p=lambda g,n=0:[[max({*s[:i],x}&{*s[i::3],x})for i,x in enumerate(r)]for*r,s in zip(*n or p(zip(*g),g),g)]