p=lambda g,*r,i=-1:[max({*g[:(i:=i+1)],x}&{*g[i::3],x})for x in r]or[*map(p,g,*map(p,zip(*g),*g))]