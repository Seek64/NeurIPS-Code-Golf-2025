def p(g):b,*l=[x for x in sum(g,[])if x];m=[[v for*c,v in zip(*g,r)if b in c[:15]]for r in g if b in r];R=range(o:=4-(len({*l[:-9]})<3));n=len(m[0])//o;return[[l[-o*o+i*o+j]*(m[i*n][j*n]>0)for j in R]for i in R]