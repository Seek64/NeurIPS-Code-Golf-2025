def p(g):
 for i in range(64):
  *h,=zip(*g);w=4-i//16;i%=16-w
  for j in range(w*4*all(5in r for r in h[i:i+w])):m=max((-(1in sum(h[j:j+w],())),-len(q:={y.index(5)-x.index(min(x))for x,y in zip(h[j:j+w],h[i:i+w])}),min(q),j%w,j)for j in range(16-w));g[6-m[2]+j%4][m[4]+j//4]+=h[i+j//4][6+j%4]%4;g[6+j%4][i+j//4]=0
 return g