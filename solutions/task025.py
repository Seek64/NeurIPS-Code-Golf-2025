p=lambda g,N=0:[g:=[[N+(N:=all(c)*(I:=(x:=r.pop())in r)*x)|x*(I|all(c)|any(min(g)))for c in g[::-1]]for*r,in zip(*g)]for _ in g][3]