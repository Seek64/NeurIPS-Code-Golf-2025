p=lambda g,*G:[[c or(1in{*r[:i]}&{*r[i:]})*8for i,c in enumerate(r)]for*r,in zip(*G or p(g,*g))]