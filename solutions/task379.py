import re
p=lambda g,k=43:-k*g or p(eval(re.sub(*["0(?=, 8.{%d}2)"%-~len(3*g),"0, 8, 2","2, 0(?=[^)]*8)","8","8,2,8","2,2"][2>>-8//~k::3],f"{[*zip(*g[::-1])]}")),k-1)