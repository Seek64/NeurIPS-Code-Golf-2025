from re import*
def p(g,S=str):*_,a,b=sorted('123456789',key=S(g).count);exec("g[:]=zip(*g[(max(findall(b+f'(?:, {b})+',S(g)))in S(g[-1]))-2::-1]);"*A);return eval(sub(b,a,S(g)))