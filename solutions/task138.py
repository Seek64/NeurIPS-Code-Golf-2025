p=lambda g,k=0:[g:=[[max({*r[i:]}&{r[0]*t,c})for i,c in enumerate(r)]for*r,in zip(*g[::-1])if k|(k:=k^all(r))|t]for t in[0]*4+[1]*4][7]