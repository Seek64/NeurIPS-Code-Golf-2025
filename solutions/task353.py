p=lambda g,k=-3,*t,r=[]:k*g or[t:=l[::-1]for l in zip(*p(g,k+1))if{4}-{*t}or(r:=[t:=l])*0]+r