p=lambda g:[[r[any(b)>f]for*r,f in zip(a,[0]+a,[0]+b)]for a,b in zip(g,g[1:]+g)]