*Z,p=0,lambda g,h=0:[[max(x,max(c),key=(Z*99+r).count)for*c,x in zip(Z+r,r[1:]+Z,r)]for*r,in zip(*h or p(g,g))]