p=lambda g,*P:[*zip(*[P:=-n*c+[0]*len(P)for n,*c in sorted((-sum(g,g).count(e),e)for e in{*sum(g,[])})])]