p=lambda g,n=-3:n*g or[[z*(sum(g,g).count(z)>3and z!=y)for z in r]+[y*(y in r)or x,y]for*r,x,y in zip(*p(g,n+1)[::-1])]