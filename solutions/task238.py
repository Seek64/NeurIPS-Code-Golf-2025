exec(f"""def p(g):
	G=g;{"G=[r%sG)if 8in r];g=[r%sg)if{*r}-{8,0}];"*2}
	for l in g[1:-1]:l[1:-1]=G.pop(0)
	{"i=0;g=[[c%%~c&r[0]for c in r[:z]]+r[z:]%sg[::-1])if[z:=min(i,len(g)-(i:=i+1))]];"*4}
	return g"""%(*[" for*r,in zip(*"]*8,))