from re import*
def p(g):
 for p in(w:=sum(g,[])):w.count(p)>3<w[::-1].index(p)+w.index(p)-392<7>(c:=p)
 for n in[11,271,1]*4:
  if x:=search(f'{c}{"."*n}([1-9])',g:=str(g)):v=int(x[1]);[g:=sub(f'([v{c}]{"."*n})[0{v}]',r'\1v',g)for _ in g]
  *g,=zip(*eval(g)[::-1])
 return g