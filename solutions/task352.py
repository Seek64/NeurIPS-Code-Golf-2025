p=lambda g,n=-3:g*n or p([(g:=[x|(2in[g.pop(0)]+g[:1])for x in r])[::-1]for*r,in zip(*g)],n+1)