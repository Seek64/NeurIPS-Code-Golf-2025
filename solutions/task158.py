def p(m):b=max(m[0],key=m[0].count);y,=[y for j in(m,m[::-1])for x in range(len(m)-2)for l in range(len(m[0])-2)if len(set(y:=[j[x+e//3][l+e%3]for e in range(9)]))>3>0<b!=y[0]!=y[8]!=b];[(o:=lambda y=b,n=b,a=b,*m:[y]*l+[n]*l+[a]*l)(o(y[0]),o(),o(a=y[8]))!=[j[x+d][a:[a+3*l*e,None][a+3*l*e<0]:e]for d in range(3*l)]or exec('for d in range(3*l):j[x+d][a:[a+3*l*e,None][a+3*l*e<0]:e]=o(*y[d//l*3:])')for l in range(4)for e in(1,-1)for x in range(len(m)-3*l+1)for a in range(len(m[0]))for j in(m,m[::-1])];return m