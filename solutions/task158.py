def p(m):b=max(m[0],key=m[0].count);y,=[y for x in range(len(m)*2-2)for l in range(len(m[0])-2)if len(set(y:=[(m+m[::-1])[x+e//3][l+e%3]for e in range(9)]))>3>0<y[0]!=y[8]];[(o:=lambda y=b,n=b,a=b,*m:[y]*l+[n]*l+[a]*l)(o(y[0])[::e],o(),o(a=y[8])[::e])!=[(m+m[::-1])[x+d][a:a+3*l]for d in range(3*l)]or exec('for d in range(3*l):(m+m[::-1])[x+d][a:a+3*l]=o(*y[d//l*3:])[::e]')for l in range(4)for e in(1,-1)for x in range(len(m)*2-3*l+1)for a in range(len(m[0])-2)];return m