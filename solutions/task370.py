import re
p=lambda g:exec('l=len(g);*r,=zip(*g[::-1]);f=sum(r,());i=f.index;d=i(v:=sum({*f})-f[0])-i(0);g[:]=eval(re.sub(f"(?<=(0|{v}).{{{d*3+2*d//l-39**(d==40)}}})\d","v",str(r)))*(d>d%l<6)or r;'*16)or g