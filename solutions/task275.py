p=lambda g,n=3:-n*g or p([*zip(*((l:=len(g)//2)>2<8in g[0]+g[1])*[[k*l%7for k in i for l in j]for i in g[l:]for j in g[:l]]or g)][::-1],n-1)