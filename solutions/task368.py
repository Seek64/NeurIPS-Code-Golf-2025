p=lambda g,w=0,s=[0]*10:[(y:=0)or[[a&15for a in sum(g,[16])if a%5][(s:=[y:=x and(s[9]or y-(w:=max(w,y)))-~w]+s)[0]]for x in r]for r in g]