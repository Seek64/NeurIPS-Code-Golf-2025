p=lambda g,i=1,w=-1:all(k:=[r*(r==r[::w])for*r,in zip(*g*w or p(g,i,1))if i in r])*k or p(g,i+1)