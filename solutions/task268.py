import re
def p(g):v="12"["1"in"%s"%g];return[g:=eval(re.sub(s[1:],s[0],f"{*zip(*g[::-1]),}"))for s in[v+"4"]+39*["4(?<=[^0], )0(?=[^)]* [^0])"]+4*[v+"0(?=[0, ]*4)"]+27*["40(?=(.{%d}4)+, [^0])"%(3*len(g)+4)]+["4"+v]][-1]