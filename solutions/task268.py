import re
p=lambda g:(v:="12"[max(max(g))%2],k:=3*len(g)-2)and[g:=eval(re.sub(s[1:],s[0],f"{*zip(*g[::-1]),}"))for s in[v+"4"]+39*["40(?=, [^0].{%d}[^0])"%k]+4*[v+"0(?=[0, ]*(4, )+[^0])"]+27*["40(?=(.{%d}4)*, [^04].{%d}4)"%(k+6,k+3)]+["4"+v]][-1]