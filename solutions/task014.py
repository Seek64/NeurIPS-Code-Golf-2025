p=lambda g,k=0:[e for*e,in zip(*k or p(g,g))if({*g[0]}^{*g[-1]})&{*e}]