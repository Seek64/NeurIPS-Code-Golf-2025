def p(g):m=*filter(any,[[r[j]&~-(4in{*r[:j+1]}&{*r[j:]})for j in range(13)]for r in zip(*g)]),;l=sum(g,g);a,*_,b=l[l.index(4)+13:][:len(m)+2];return[z:=[4,*_,4],*[[a,*r[::1|-(b in m[0])],b]for r in zip(*m)if sum(r)],z]