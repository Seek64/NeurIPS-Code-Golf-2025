p=lambda g:[[*map(max,*[r*any(i*j*(i-j)for i,j in zip(r,s))+s for s in g])]for*r,in zip(*g)]