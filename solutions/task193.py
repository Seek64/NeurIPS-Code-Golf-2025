p=lambda g,*G:[[w&max(k)for*k,w in zip([0]+r,r[1:]+[0],r)]for*r,in zip(*G or p(g,*g))]