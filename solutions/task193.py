p=lambda g,*G:[[r.pop(0)&(b|[*r,0][0])for b in[0]+r[:-1]]for*r,in zip(*G or p(g,*g))]