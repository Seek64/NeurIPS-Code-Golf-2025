p=lambda g,n=3:(x:=-n*g)or p([[r.pop()or(2+n%2in r!=3-n%2in(x:=x+g.pop()))*8for _ in r*1]for*r,in zip(*g)],n-1)