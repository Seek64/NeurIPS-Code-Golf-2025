p=lambda g,n=39:-n*g or p([*zip(*[g,h:=[[*map(max,r,(r*3)[n%-17::-1])]for r in g]][5in map(str(h).count,str(h))])],n-1)