def p(g,w=1):h=g;[h:=[r[r.index(w)+x:]for*r,in zip(*h[::-1])if w in r]for x in[0]*4+[1]*4];return h*any(h)or p(g,w+1)