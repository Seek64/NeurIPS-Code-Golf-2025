def p(g,w=1):h=g;return[h:=[r[~x::-1]for*r,in zip(*h)if w in r]for x in[0]*4+[1]*5][7]*(h==[])or p(g,w+1)