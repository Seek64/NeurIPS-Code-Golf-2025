p=lambda g,k=799:-k*g or p([(a:=1)*[a:=c%~c&[5-sum(g,g).count(c),max(k:=k-1,c,a)][k>98]for c in r][::-1]for*r,in zip(*g)],k)