p=lambda g,k=222:~k*g or p([(a:=1)*[a:=c and[5-sum(g,g).count(c),max(k:=k-c%2*8,c,a)][k>0]for c in r][::-1]for*r,in zip(*g)],k-2)