p=lambda g,k=-999:[g:=[(a:=0)or[a:=c and F(k:=k+1,c,a,5-sum(g,g).count(c))for c in r]for*r,in zip(*g[::-1])]for F in[min]*15+[max]][-1]