p=lambda g,k=0:[g:=[[c+(k:=k^~-r.count(c)*c)%1or k for c in r]for*r,in zip(*g)]for _ in g][1]