p=lambda g,*G:[r*((w:=len({*r})-1)<2)or[max(r[i%w::w])for i in range(len(r))]for*r,in zip(*G or p(g,*g))]