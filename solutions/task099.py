p=lambda g,n=0:[g:=[r.pop(0)or(1in g)>0<x and~-sum({*g})for x in g]for r in(n or p(g,g))[::-1]]