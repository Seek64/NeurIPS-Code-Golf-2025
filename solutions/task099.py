p=lambda g,n=0,*q:[q:=[x or(1in{*q[:i+1]}&{*q[i:]})*~-sum({*q})for i,x in enumerate(r)]for r in(n or p(g,g))[::-1]]