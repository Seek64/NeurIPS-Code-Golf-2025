import re
p=lambda g,k=27,n=2:-k*g or p(eval(re.sub(["(?<=[28], )5(?=[^0)]{,9}2)","5(?=.{,%d}[28], [28].{%d}[28]|..{%d}(, [28]){%d}|(, [28]){%d}..( |0|.{15}8, 8))"%(3*n,3*len(g)-2,3*len(g)-2-3*n,1+2*n,2*n)][k<12],"8",f"{*zip(*g[::-1]),}")),k-1,n|("*"in re.sub(6*", [28]","*",f"{*zip(*g[::-1]),}")))