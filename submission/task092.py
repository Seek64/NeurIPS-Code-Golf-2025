p=lambda g,h=0:[[x or max({*c[:i+1]}&{*c[i:]})for i,x in enumerate(c)]for c in zip(*h or p(g,g))]